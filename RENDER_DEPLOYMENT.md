# Deploying PawSocial to Render

## Quick Setup

### 1. Push to GitHub (if not already done)
```bash
git add .
git commit -m "Add Render deployment configuration"
git push origin main
```

### 2. Deploy Backend API

1. Go to [Render Dashboard](https://dashboard.render.com/)
2. Click **"New +"** → **"Blueprint"**
3. Connect your GitHub repository: `shaw2024/pawsocial`
4. Render will detect `render.yaml` and show two services:
   - `pawsocial-api` (Backend)
   - `pawsocial-client` (Frontend)

### 3. Configure Environment Variables

After the blueprint is created, go to the **pawsocial-api** service:

1. Click on **"Environment"** tab
2. Add/update these environment variables:
   - `MONGO_URL`: Your MongoDB Atlas connection string
     ```
     mongodb+srv://shw30_db_user:Goodday2025@pawpawsocial.cndiwia.mongodb.net/pawsocial
     ```
   - `JWT_SECRET`: (already auto-generated by Render)
   - `NODE_ENV`: `production`

3. Click **"Save Changes"**

### 4. Update MongoDB Atlas Network Access

1. Go to [MongoDB Atlas](https://cloud.mongodb.com/)
2. Navigate to **Network Access**
3. Click **"Add IP Address"**
4. Select **"Allow Access from Anywhere"** (0.0.0.0/0)
   - Or add Render's IP ranges if you prefer more security
5. Click **"Confirm"**

### 5. Wait for Deployment

- Backend typically takes 2-3 minutes
- Frontend takes 3-5 minutes
- You'll get URLs like:
  - Backend: `https://pawsocial-api.onrender.com`
  - Frontend: `https://pawsocial-client.onrender.com`

### 6. Update API URL (if different)

If your backend URL is different from `pawsocial-api.onrender.com`:

1. Update `client/src/api.js`:
   ```javascript
   const baseURL = process.env.REACT_APP_API_URL || 
     (process.env.NODE_ENV === 'production' 
       ? 'https://YOUR-ACTUAL-API.onrender.com'  // ← Change this
       : 'http://localhost:4000');
   ```

2. Update `server/index.js` CORS origin:
   ```javascript
   "https://YOUR-ACTUAL-CLIENT.onrender.com"  // ← Change this
   ```

3. Commit and push changes

## Testing Deployment

Once deployed, test your app:

1. **Backend Health Check:**
   ```bash
   curl https://pawsocial-api.onrender.com/health
   ```
   Should return: `{"status":"ok","timestamp":"..."}`

2. **Frontend:**
   Visit `https://pawsocial-client.onrender.com`

3. **Test Image Upload:**
   - Navigate to "My Page"
   - Click "Add a Dog"
   - Upload an image and fill in details
   - Click "Save Dog"
   - Check if the dog appears with the image

## Troubleshooting

### Backend won't start
- Check logs in Render dashboard
- Verify `MONGO_URL` is set correctly
- Ensure MongoDB Atlas allows connections from 0.0.0.0/0

### Frontend can't connect to backend
- Check CORS settings in `server/index.js`
- Verify `REACT_APP_API_URL` environment variable
- Check browser console for errors

### Images not uploading
- Check backend logs for error messages
- Verify MongoDB connection is active
- Test with small images first (< 1MB)

## Free Tier Limitations

⚠️ **Important:** Render's free tier:
- Services spin down after 15 minutes of inactivity
- First request after spin-down takes 30-60 seconds
- 750 hours/month per service (enough for one always-on service)

Consider upgrading to paid tier ($7/month per service) for:
- No spin-down
- Faster performance
- Custom domains

## Local Development

To run locally:

```bash
# Terminal 1 - Backend
cd server
npm install
npm run start:mongo

# Terminal 2 - Frontend
cd client
npm install
npm start
```

Visit `http://localhost:3000`
